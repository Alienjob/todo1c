Перем ЮТест; // ссылка на экземпляр фреймворка xUnitFor1C - объект обработки UnitTestRunner

Перем ОбработкаОбъект;
Перем ИмяФайлаВнешнейОбработки;

Функция ПолучитьСписокТестов(ЮнитТестирование) Экспорт

    	ЮТест = ЮнитТестирование;

    	ВсеТесты = Новый Массив;

    	ВсеТесты.Добавить("ТестДолжен_СложитьДваИДва");
    	ВсеТесты.Добавить("ТестДолжен_ДобавитьЗадачу");
	ВсеТесты.Добавить("ТестДолжен_ВыполнитьЗадачу");

    Возврат ВсеТесты;

КонецФункции

Процедура ПередЗапускомТеста() Экспорт
	ОбработкаОбъект = ВнешниеОбработки.Создать(ИмяФайлаВнешнейОбработки);
	НачатьТранзакцию();
КонецПроцедуры

Процедура ПослеЗапускаТеста() Экспорт
	Если ТранзакцияАктивна() Тогда
		ОтменитьТранзакцию();
	КонецЕсли;
  	ОбработкаОбъект = Неопределено;
КонецПроцедуры

Процедура ТестДолжен_СложитьДваИДва() Экспорт
    ЮТест.ПроверитьРавенство(2 + 2, 4, "2 + 2, 4");
КонецПроцедуры

/////////////////////////////////////////////////////////
//Здесь будем писать наши тесты

Процедура ТестДолжен_ДобавитьЗадачу() Экспорт
	
    ОбработкаОбъект.ДобавитьЗадачу("Пройти первый тест");	
    
    ЮТест.ПроверитьРавенство(ОбработкаОбъект.СписокЗадач.Количество(), 1, "Задача не добавлена");
	
КонецПроцедуры

Процедура ТестДолжен_ВыполнитьЗадачу() Экспорт
	
    ОбработкаОбъект.ДобавитьЗадачу("Пройти второй тест");	
    
    ЮТест.ПроверитьРавенство(ОбработкаОбъект.СписокЗадач[0].Выполнена, Ложь, "Задача создана выполненной");
    
    ОбработкаОбъект.ВыполнитьЗадачу(0);	
    
    ЮТест.ПроверитьРавенство(ОбработкаОбъект.СписокЗадач[0].Выполнена, Истина, "Задача не выполнена");
	
КонецПроцедуры

ИмяФайлаВнешнейОбработки = "E:\todo1c\develop\epf\todo1c.epf";